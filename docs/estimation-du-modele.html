<!DOCTYPE html>
<html  lang="french">

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Régression linéaire</title>
  <meta name="description" content="Régression linéaire">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Régression linéaire" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Régression linéaire" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="fabrication-des-donnees.html">
<link rel="next" href="variations.html">
<style type="text/css">
p.abstract{
  text-align: center;
  font-weight: bold;
}
div.abstract{
  margin: auto;
  width: 90%;
}
</style>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="contexte.html"><a href="contexte.html"><i class="fa fa-check"></i><b>1</b> Contexte</a></li>
<li class="chapter" data-level="2" data-path="fabrication-des-donnees.html"><a href="fabrication-des-donnees.html"><i class="fa fa-check"></i><b>2</b> Fabrication des données</a></li>
<li class="chapter" data-level="3" data-path="estimation-du-modele.html"><a href="estimation-du-modele.html"><i class="fa fa-check"></i><b>3</b> Estimation du modèle</a></li>
<li class="chapter" data-level="4" data-path="variations.html"><a href="variations.html"><i class="fa fa-check"></i><b>4</b> Variations</a><ul>
<li class="chapter" data-level="4.1" data-path="variations.html"><a href="variations.html#erreur-du-modele"><i class="fa fa-check"></i><b>4.1</b> Erreur du modèle</a></li>
<li class="chapter" data-level="4.2" data-path="variations.html"><a href="variations.html#nombre-de-points"><i class="fa fa-check"></i><b>4.2</b> Nombre de points</a></li>
<li class="chapter" data-level="4.3" data-path="variations.html"><a href="variations.html#calcul-des-elements-du-modele"><i class="fa fa-check"></i><b>4.3</b> Calcul des éléments du modèle</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="design-experimental.html"><a href="design-experimental.html"><i class="fa fa-check"></i><b>5</b> Design expérimental</a><ul>
<li class="chapter" data-level="5.1" data-path="design-experimental.html"><a href="design-experimental.html#performance"><i class="fa fa-check"></i><b>5.1</b> Performance</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>6</b> Conclusion</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Régression linéaire</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="estimation-du-modele" class="section level1">
<h1><span class="header-section-number">3</span> Estimation du modèle</h1>
<p>L’estimation du modèle est faite par la fonction <em>lm()</em> de R :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Regression &lt;-<span class="st"> </span><span class="kw">lm</span>(Y <span class="op">~</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X2)
<span class="kw">summary</span>(Regression)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Y ~ X1 + X2)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -243.196  -56.711    1.888   65.774  232.366 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)   6.6636    26.6681   0.250    0.803
## X1            2.0054     0.3724   5.385 5.05e-07
## X2            2.8550     0.3683   7.751 9.04e-12
##                
## (Intercept)    
## X1          ***
## X2          ***
## ---
## Signif. codes:  
## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 103.4 on 97 degrees of freedom
## Multiple R-squared:  0.4925, Adjusted R-squared:  0.482 
## F-statistic: 47.06 on 2 and 97 DF,  p-value: 5.186e-15</code></pre>
<p>Utiliser l’aide de R pour une explication détaillée du fonctionnement de la fonction.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">help</span>(lm)</code></pre></div>
<p>L’estimation des coefficients se trouve dans le tableau de résultat :</p>
<ul>
<li><span class="math inline">\(\hat{b}=6.6636\)</span></li>
<li><span class="math inline">\(\hat{a}_1=2.0054\)</span></li>
<li><span class="math inline">\(\hat{a}_2=2.855\)</span></li>
</ul>
<p>Les vraies valeurs sont 1, 2 et 3 : l’estimation n’est pas très bonne parce que l’erreur du modèle a été conçue pour être grande. Les estimateurs ont un intervalle de confiance connu puisque l’erreur du modèle est normale. On note <span class="math inline">\(\sigma_{\hat{a}_1}\)</span> l’écart-type de l’estimateur de <span class="math inline">\(a_1\)</span> et <span class="math inline">\(t_{(n-3)}^\alpha\)</span> la valeur critique de la loi de Student au seuil de risque <span class="math inline">\(\alpha\)</span> à <span class="math inline">\(n-3\)</span> degrés de liberté (<span class="math inline">\(n\)</span> est le nombre d’observations, auquel il faut retirer le nombre de variables explicatives plus 1 pour obtenir le nombre de degrés de liberté du modèle). L’intervalle de confiance est donné par : <span class="math display">\[a_1 = \hat{a}_1 \pm t_{(n-3)}^\alpha \frac{\sigma_{\hat{a}_1}}{\sqrt{n}}\]</span> <span class="math inline">\(t_{(n-3)}^\alpha\)</span> vaut à peu près 2 si n n’est pas trop petit, au seuil de risque <span class="math inline">\(\alpha=5\%\)</span> (dit autrement, au seuil de confiance de 95%). <span class="math inline">\({\sigma_{\hat{a}_1}}/{\sqrt{n}}\)</span> est appelée <em>erreur standard</em> de l’estimateur et est affichée dans les sorties de <em>lm()</em>. Un test de Student est appliqué à chaque estimateur pour s’assurer qu’il est bien différent de 0 (ce qui signifierait que <span class="math inline">\(y\)</span> ne serait pas lié à cette variable explicative). La probabilité de se tromper en rejetant l’hypothèse de la nullité de l’estimateur est affichée dans la dernière colonne. Classiquement, on retient le coefficient si cette probabilité est inférieure à 5%. Dans notre exemple, la constante est peut-être nulle (on a 80,3% de chance de se tromper en affirmant le contraire), les autres coefficients sont presque certainement non nuls (moins de 0,1% de chances de se tromper, illustré par trois étoiles à côté de la probabilité). Le nuage de points peut être représenté graphiquement avec la librairie <em>scatterplot3d</em> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;scatterplot3d&quot;</span>)
s3d &lt;-<span class="st"> </span><span class="kw">scatterplot3d</span>(X1, X2, Y, <span class="dt">highlight.3d =</span> <span class="ot">TRUE</span>)
bhat &lt;-<span class="st"> </span>Regression<span class="op">$</span>coefficients[<span class="dv">1</span>]
a1hat &lt;-<span class="st"> </span>Regression<span class="op">$</span>coefficients[<span class="dv">2</span>]
a2hat &lt;-<span class="st"> </span>Regression<span class="op">$</span>coefficients[<span class="dv">3</span>]
s3d<span class="op">$</span><span class="kw">plane3d</span>(bhat, a1hat, a2hat, <span class="dt">lty.box =</span> <span class="st">&quot;solid&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:donnees"></span>
<img src="Cours-InitStat-Regression_files/figure-html/donnees-1.png" alt="Représentation graphique de la régression linéaire à deux variables explicatives. L'estimation du modèle fournit un plan." width="\maxwidth" />
<p class="caption">
Figure 3.1: Représentation graphique de la régression linéaire à deux variables explicatives. L’estimation du modèle fournit un plan.
</p>
</div>
<p>La part de la variabilité de <span class="math inline">\(Y\)</span> expliquée par le modèle est quantifiée par son <span class="math inline">\(R^2\)</span> : 49%. Le reste (51%) est la variabilité non expliquée, celle de l’erreur du modèle : si elle était nulle, tous les points seraient situés sur le plan. La valeur de <span class="math inline">\(R^2\)</span> est dans les sorties de <em>lm()</em>, on peut aussi la calculer directement :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var</span>(X <span class="op">%*%</span><span class="st"> </span><span class="kw">c</span>(a1hat, a2hat, bhat))<span class="op">/</span><span class="kw">var</span>(Y)</code></pre></div>
<pre><code>##           [,1]
## [1,] 0.4924724</code></pre>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="fabrication-des-donnees.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="variations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
