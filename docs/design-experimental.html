<!DOCTYPE html>
<html  lang="french">

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Régression linéaire</title>
  <meta name="description" content="Régression linéaire">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Régression linéaire" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Régression linéaire" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="variations.html">
<link rel="next" href="conclusion.html">
<style type="text/css">
p.abstract{
  text-align: center;
  font-weight: bold;
}
div.abstract{
  margin: auto;
  width: 90%;
}
</style>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="contexte.html"><a href="contexte.html"><i class="fa fa-check"></i><b>1</b> Contexte</a></li>
<li class="chapter" data-level="2" data-path="fabrication-des-donnees.html"><a href="fabrication-des-donnees.html"><i class="fa fa-check"></i><b>2</b> Fabrication des données</a></li>
<li class="chapter" data-level="3" data-path="estimation-du-modele.html"><a href="estimation-du-modele.html"><i class="fa fa-check"></i><b>3</b> Estimation du modèle</a></li>
<li class="chapter" data-level="4" data-path="variations.html"><a href="variations.html"><i class="fa fa-check"></i><b>4</b> Variations</a><ul>
<li class="chapter" data-level="4.1" data-path="variations.html"><a href="variations.html#erreur-du-modele"><i class="fa fa-check"></i><b>4.1</b> Erreur du modèle</a></li>
<li class="chapter" data-level="4.2" data-path="variations.html"><a href="variations.html#nombre-de-points"><i class="fa fa-check"></i><b>4.2</b> Nombre de points</a></li>
<li class="chapter" data-level="4.3" data-path="variations.html"><a href="variations.html#calcul-des-elements-du-modele"><i class="fa fa-check"></i><b>4.3</b> Calcul des éléments du modèle</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="design-experimental.html"><a href="design-experimental.html"><i class="fa fa-check"></i><b>5</b> Design expérimental</a><ul>
<li class="chapter" data-level="5.1" data-path="design-experimental.html"><a href="design-experimental.html#performance"><i class="fa fa-check"></i><b>5.1</b> Performance</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>6</b> Conclusion</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Régression linéaire</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="design-experimental" class="section level1">
<h1><span class="header-section-number">5</span> Design expérimental</h1>
<div id="performance" class="section level2">
<h2><span class="header-section-number">5.1</span> Performance</h2>
<p>Les valeurs de <span class="math inline">\(\mathbf{Y}\)</span>, et donc l’estimation des paramètres du modèle et de son erreur, ne sont connues qu’après l’expérience. Mais les valeurs de <span class="math inline">\(\mathbf{X}\)</span> sont connues avant : leur choix est le design expérimental. L’objectif principal de l’estimation d’un modèle linéaire est l’estimation aussi précise que possible de ses paramètres. Pour cela, l’erreur standard doit être aussi faible et le nombre d’observation aussi grand que possible. L’erreur standard des estimateurs est donnée par la diagonale de <span class="math inline">\(\mathbf{\Sigma}=(\mathbf{X}&#39;\mathbf{X})^{-1}\)</span> multipliée par l’écart-type de l’erreur du modèle. L’erreur du modèle dépendra des données, mais le design permet de minimiser la diagonale de <span class="math inline">\(\mathbf{\Sigma}\)</span>. L’erreur standard est minimale pour tous les coefficients si toutes les combinaisons des valeurs extrêmes des variables explicatives sont utilisées <span class="citation">(Cochran et Cox 1992)</span> : ce design est appelé <em>design factoriel</em>. Le nombre de combinaison est 2 à la puissance le nombre de facteurs ; dans notre exemple, les valeurs seraient : <span class="math display">\[\mathbf{X} = \begin{pmatrix}
   0   &amp; 0   &amp; 1 \\
   0   &amp; 100 &amp; 1 \\
   100 &amp; 100 &amp; 1 \\
   100 &amp; 100 &amp; 1 \\
\end{pmatrix}\]</span> La valeur de l’erreur standard de chaque variable est connue dans ce cas : elle est égale à la moitié de l’écart entre les deux valeurs extrêmes de la variable explicative multipliée par le nombre d’observations.</p>
<p>Si le design n’est pas factoriel, l’erreur standard des coefficients sera plus grande. Le rapport entre l’erreur standard du design factoriel est celle du design choisi est appelé la performance du design <span class="citation">(Baraloto et al. 2010)</span>. Avec les 100 observations uniformément distribuées de la simulation précédente, le calcul est le suivant :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Facteur d&#39;échelle = écart-type des deux extrêmes</span>
S &lt;-<span class="st"> </span><span class="kw">apply</span>(X, <span class="dv">2</span>, <span class="cf">function</span>(Xj) (<span class="kw">max</span>(Xj) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(Xj))<span class="op">/</span><span class="dv">2</span>)
<span class="co"># Performance</span>
(P &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(S <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">diag</span>(Sigma) <span class="op">*</span><span class="st"> </span><span class="kw">nrow</span>(X))))</code></pre></div>
<pre><code>##        X1        X2           
## 0.2275832 0.2005624       Inf</code></pre>
<p>Dans cet exemple, les valeurs des variables explicatives ont été choisies uniformément entre 0 et 100. La performance du design est de 23% pour <span class="math inline">\(x_1\)</span> et 20% pour <span class="math inline">\(x_2\)</span>, ce qui signifie que l’erreur standard de l’estimateur de <span class="math inline">\(a_2\)</span> est 5 fois plus grande que dans le design factoriel. Toutes choses égales par ailleurs, il faudra 25 fois plus d’observations pour obtenir le même intervalle de confiance pour cet estimateur. La dernière valeur (<em>Inf</em>) n’a pas de signification.</p>
<p>La performance est nettement améliorée en se rapprochant du design factoriel :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Tirage de 2500 valeurs</span>
NbX &lt;-<span class="st"> </span><span class="dv">2500</span>
X1 &lt;-<span class="st"> </span><span class="kw">runif</span>(NbX) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>
X2 &lt;-<span class="st"> </span><span class="kw">runif</span>(NbX) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>
X &lt;-<span class="st"> </span><span class="kw">cbind</span>(X1, X2, <span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">length</span>(X1)))
E &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">nrow</span>(X)) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>
Y &lt;-<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>Theta <span class="op">+</span><span class="st"> </span>E
<span class="co"># Elimination des valeurs intermédiaires (4% des</span>
<span class="co"># points sont conservés)</span>
Extreme &lt;-<span class="st"> </span>(X1 <span class="op">&lt;</span><span class="st"> </span><span class="dv">10</span> <span class="op">|</span><span class="st"> </span>X1 <span class="op">&gt;</span><span class="st"> </span><span class="dv">90</span>) <span class="op">&amp;</span><span class="st"> </span>(X2 <span class="op">&lt;</span><span class="st"> </span><span class="dv">10</span> <span class="op">|</span><span class="st"> </span>X2 <span class="op">&gt;</span><span class="st"> </span><span class="dv">90</span>)
X1 &lt;-<span class="st"> </span>X1[Extreme]
X2 &lt;-<span class="st"> </span>X2[Extreme]
X &lt;-<span class="st"> </span><span class="kw">cbind</span>(X1, X2, <span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">length</span>(X1)))
E &lt;-<span class="st"> </span>E[Extreme]
Y &lt;-<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>Theta <span class="op">+</span><span class="st"> </span>E
(Sigma &lt;-<span class="st"> </span><span class="kw">solve</span>(<span class="kw">t</span>(X) <span class="op">%*%</span><span class="st"> </span>X))</code></pre></div>
<pre><code>##               X1            X2              
## X1  5.479472e-06 -2.920513e-07 -0.0002496656
## X2 -2.920513e-07  5.638243e-06 -0.0002361176
##    -2.496656e-04 -2.361176e-04  0.0336762622</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Facteur d&#39;échelle = écart-type des deux extrêmes</span>
S &lt;-<span class="st"> </span><span class="kw">apply</span>(X, <span class="dv">2</span>, <span class="cf">function</span>(Xj) (<span class="kw">max</span>(Xj) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(Xj))<span class="op">/</span><span class="dv">2</span>)
<span class="co"># Performance</span>
(P &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(S <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">diag</span>(Sigma) <span class="op">*</span><span class="st"> </span><span class="kw">nrow</span>(X))))</code></pre></div>
<pre><code>##        X1        X2           
## 0.9135162 0.8954324       Inf</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Figure</span>
Regression &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> Y <span class="op">~</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X2)
s3d &lt;-<span class="st"> </span><span class="kw">scatterplot3d</span>(X1, X2, Y, <span class="dt">highlight.3d =</span> <span class="ot">TRUE</span>)
bhat &lt;-<span class="st"> </span>Regression<span class="op">$</span>coefficients[<span class="dv">1</span>]
a1hat &lt;-<span class="st"> </span>Regression<span class="op">$</span>coefficients[<span class="dv">2</span>]
a2hat &lt;-<span class="st"> </span>Regression<span class="op">$</span>coefficients[<span class="dv">3</span>]
s3d<span class="op">$</span><span class="kw">plane3d</span>(bhat, a1hat, a2hat, <span class="dt">lty.box =</span> <span class="st">&quot;solid&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:regextreme"></span>
<img src="Cours-InitStat-Regression_files/figure-html/regextreme-1.png" alt="Elimination des valeurs intermédiaires des facteurs." width="\maxwidth" />
<p class="caption">
Figure 5.1: Elimination des valeurs intermédiaires des facteurs.
</p>
</div>
<p>La performance est ici proche 90% pour les deux variables.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="variations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="conclusion.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": [["Cours-InitStat-Regression.pdf", "PDF"]],
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
